AWSTemplateFormatVersion: "2010-09-09"
Transform: AWS::Serverless-2016-10-31
Description: >
  LineBot-HappyBirthdayLeaderboard

Parameters:
  CelebratingTarget:
    NoEcho: true
    Type: String
  LineBotSecret:
    NoEcho: true
    Type: String
  LineBotAccessToken:
    NoEcho: true
    Type: String

Resources:
  ResponseForPostRequests:
    Type: AWS::Serverless::Function # More info about Function Resource: https://github.com/awslabs/serverless-application-model/blob/master/versions/2016-10-31.md#awsserverlessfunction
    Properties:
      CodeUri: ./src
      Handler: app.response
      Runtime: python3.7
      Environment:
        Variables:
          CELEBRATING_TARGET:
            Ref: CelebratingTarget
          LINEBOT_SECRET:
            Ref: LineBotSecret
          LINEBOT_ACCESS_TOKEN:
            Ref: LineBotAccessToken
      Events:
        PutRequest:
          Type: Api
          Properties:
            Path: /callback/
            Method: post
